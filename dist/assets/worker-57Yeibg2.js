(function(){"use strict";self.onmessage=z=>{let s=z.data,o=new t(s.start,s.end),e=JSON.parse(s.data);o.setBaseData(e.playRecipes2,e.playChefs,e.recipe2Change,e.tempCalCache);let l=o.call();self.postMessage({type:"r",maxK:l})};class t{constructor(s,o){this.playRecipes=null,this.playChefs=null,this.start=0,this.scoreCache=null,this.groupScoreCacheNoIndex=null,this.groupScoreCache=null,this.recipe2Change=null,this.start=s,this.limit=o}static __static_initialize(){t.__static_initialized||(t.__static_initialized=!0,t.__static_initializer_0())}static disordePermuation_$LI$(){if(t.__static_initialize(),t.disordePermuation==null){t.disordePermuation=new Array(1680);for(let s=0;s<1680;s++)t.disordePermuation[s]=new Array(9).fill(0)}return t.disordePermuation}static __static_initializer_0(){const s=[0,1,2,3,4,5,6,7,8];t.permute(s,[0,0,0,0,0,0,0,0,0],[0,0,0],0)}setBaseData(s,o,e,l){this.playRecipes=s,this.playChefs=o,this.scoreCache=l.scoreCacheNoEquip,this.groupScoreCacheNoIndex=l.groupScoreCacheNoIndex,this.groupScoreCache=l.groupScoreCache,this.recipe2Change=e}call(){let s=Date.now(),o=0,e=new Array(this.playChefs.length);for(let i=0;i<e.length;i++)e[i]=this.playChefs[i][2];let l=new Array(this.groupScoreCache.length).fill(!1),r=0;for(let i=0;i<this.groupScoreCache.length;i++)for(let n of this.groupScoreCache[i])n>r&&(r=n);r=.35*r;for(let i=0;i<this.groupScoreCache.length;i++){let n=0,a=!1;for(let h of this.groupScoreCache[i])n+=h,h>r&&(a=!0);l[i]=n===0||!a}let B=0,y=0,_=BigInt(0),m,S,C,I=0;for(let i=this.start;i<this.limit;i++){let n=(i-this.start)/(this.limit-this.start)*100|0;n>I&&(self.postMessage({type:"p",p:n-I}),I=n);const a=this.playRecipes[i];let h=0;for(let p=0;p<1680;p++){const c=t.disordePermuation_$LI$()[p];if(m=this.groupScoreCacheNoIndex[a[c[0]]][a[c[1]]]+(a[c[2]]-a[c[1]]-1),S=this.groupScoreCacheNoIndex[a[c[3]]][a[c[4]]]+(a[c[5]]-a[c[4]]-1),C=this.groupScoreCacheNoIndex[a[c[6]]][a[c[7]]]+(a[c[8]]-a[c[7]]-1),l[m]||l[S]||l[C])continue;let N=this.groupScoreCache[C];for(let x=0,u=0,g=0,f;x<this.recipe2Change.length;x++){f=this.recipe2Change[x];let d=this.playChefs[u],P=this.groupScoreCache[m][d[0]];if(P===0){u=f;continue}if(g=P+this.groupScoreCache[S][d[1]],g===0){u=f;continue}for(let $=Math.max(B-g,0);u<f;u++)h=N[e[u]],h>$&&(h+=g,h>y&&(y=h,_=((BigInt(h)<<18n|BigInt(i))<<11n|BigInt(p))<<14n|BigInt(u)))}}}return o=Date.now(),console.info(this.limit-this.start+"全菜谱 全厨师 无厨具排列结果用时:"+(o-s)+"ms"),console.log(this.start),_}static permute(s,o,e,l){if(e[0]+e[1]+e[2]===9){for(let r=0;r<9;r++)t.disordePermuation_$LI$()[t.index][r]=o[r];t.index++;return}for(let r=0;r<3;r++)e[r]!==3&&(o[r*3+e[r]]=s[l],e[r]++,t.permute(s,o,e,l+1),e[r]--)}}t.__static_initialized=!1,t.index=0,t.disordePermuation_$LI$(),t.__static_initialize()})();
