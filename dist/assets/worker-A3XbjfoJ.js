(function(){"use strict";self.onmessage=_=>{let s=_.data,o=new t(s.start,s.end),i=JSON.parse(s.data);o.setBaseData(i.playRecipes2,i.playChefs,i.recipe2Change,i.tempCalCache);let r=o.call();self.postMessage({type:"r",maxK:r})};class t{constructor(s,o){this.playRecipes=null,this.playChefs=null,this.start=0,this.scoreCache=null,this.scoreCacheNoEquipIndex=null,this.scoreAddCacheNoEquip=null,this.recipe2Change=null,this.start=s,this.limit=o}static __static_initialize(){t.__static_initialized||(t.__static_initialized=!0,t.__static_initializer_0())}static disordePermuation_$LI$(){if(t.__static_initialize(),t.disordePermuation==null){t.disordePermuation=new Array(1680);for(let s=0;s<1680;s++)t.disordePermuation[s]=new Array(9).fill(0)}return t.disordePermuation}static __static_initializer_0(){const s=[0,1,2,3,4,5,6,7,8];t.permute(s,[0,0,0,0,0,0,0,0,0],[0,0,0],0)}setBaseData(s,o,i,r){this.playRecipes=s,this.playChefs=o,this.scoreCache=r.scoreCacheNoEquip,this.scoreCacheNoEquipIndex=r.scoreCacheNoEquipIndex,this.scoreAddCacheNoEquip=r.scoreAddCacheNoEquip,this.recipe2Change=i}call(){let s=Date.now(),o=0,i=new Array(this.playChefs.length);for(let e=0;e<i.length;e++)i[e]=this.playChefs[e][2];let r=new Array(this.scoreAddCacheNoEquip.length).fill(!1),a=0;for(let e=0;e<this.scoreAddCacheNoEquip.length;e++)for(let n of this.scoreAddCacheNoEquip[e])n>a&&(a=n);a=.35*a;for(let e=0;e<this.scoreAddCacheNoEquip.length;e++){let n=0,l=!1;for(let h of this.scoreAddCacheNoEquip[e])n+=h,h>a&&(l=!0);r[e]=n===0||!l}let P=0,y=0,N=BigInt(0),m,g,C,I=0;for(let e=this.start;e<this.limit;e++){let n=(e-this.start)/(this.limit-this.start)*100|0;n>I&&(self.postMessage({type:"p",p:n-I}),I=n);const l=this.playRecipes[e];let h=0;for(let p=0;p<1680;p++){const c=t.disordePermuation_$LI$()[p];if(m=this.scoreCacheNoEquipIndex[l[c[0]]][l[c[1]]]+(l[c[2]]-l[c[1]]-1),g=this.scoreCacheNoEquipIndex[l[c[3]]][l[c[4]]]+(l[c[5]]-l[c[4]]-1),C=this.scoreCacheNoEquipIndex[l[c[6]]][l[c[7]]]+(l[c[8]]-l[c[7]]-1),r[m]||r[g]||r[C])continue;let z=this.scoreAddCacheNoEquip[C];for(let x=0,u=0,d=0,f;x<this.recipe2Change.length;x++){f=this.recipe2Change[x];let q=this.playChefs[u],E=this.scoreAddCacheNoEquip[m][q[0]];if(E===0){u=f;continue}if(d=E+this.scoreAddCacheNoEquip[g][q[1]],d===0){u=f;continue}for(let B=Math.max(P-d,0);u<f;u++)h=z[i[u]],h>B&&(h+=d,h>y&&(y=h,N=((BigInt(h)<<18n|BigInt(e))<<11n|BigInt(p))<<14n|BigInt(u)))}}}return o=Date.now(),console.info(this.limit-this.start+"全菜谱 全厨师 无厨具排列结果用时:"+(o-s)+"ms"),console.log(this.start),N}static permute(s,o,i,r){if(i[0]+i[1]+i[2]===9){for(let a=0;a<9;a++)t.disordePermuation_$LI$()[t.index][a]=o[a];t.index++;return}for(let a=0;a<3;a++)i[a]!==3&&(o[a*3+i[a]]=s[r],i[a]++,t.permute(s,o,i,r+1),i[a]--)}}t.__static_initialized=!1,t.index=0,t.disordePermuation_$LI$(),t.__static_initialize()})();
